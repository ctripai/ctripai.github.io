<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ•°å­¦ç‹å›½å¤§é—¯å…³</title>
<style>
* {margin:0;padding:0;box-sizing:border-box;font-family:"å¾®è½¯é›…é»‘","å¹¼åœ†",sans-serif;}
body {background:linear-gradient(#f9f6e8, #f0ead6);min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:20px;}
.game-container {width:90%;max-width:500px;background:#faf6e9;border-radius:20px;box-shadow:0 8px 20px rgba(0,0,0,0.15);padding:25px;text-align:center;border:5px solid #ff9800;}
.title {color:#e91e63;font-size:32px;margin-bottom:15px;text-shadow:2px 2px 4px rgba(0,0,0,0.1);}
.level-info {font-size:20px;color:#2196f3;margin:10px 0;background:#f7f2df;padding:8px;border-radius:10px;}
.question-box {font-size:28px;margin:20px 0;padding:20px;background:#fff8e1;border-radius:15px;border:3px dashed #ffc107;font-weight:bold;
    white-space: nowrap;
    min-width: 200px;
}
.answer-display {
display: inline-block;
min-width: 80px;
font-size: 28px;
text-align: center;
margin: 0 5px;
color: #2e7d32;
font-weight: bold;
border-bottom: 4px solid #4caf50;
background: transparent;
vertical-align: bottom;
}
.num-keyboard {display:grid;grid-template-columns:repeat(3,1fr);gap:12px;width:280px;margin:25px auto;}
.num-btn {padding:18px 0;font-size:24px;border:none;border-radius:15px;cursor:pointer;color:#fff;font-weight:bold;box-shadow:0 4px 8px rgba(0,0,0,0.2);transition:all 0.2s;}
.num-btn:hover {transform:translateY(-3px);box-shadow:0 6px 12px rgba(0,0,0,0.25);}
.num-btn:nth-child(1) {background:#e91e63;}
.num-btn:nth-child(2) {background:#9c27b0;}
.num-btn:nth-child(3) {background:#673ab7;}
.num-btn:nth-child(4) {background:#3f51b5;}
.num-btn:nth-child(5) {background:#2196f3;}
.num-btn:nth-child(6) {background:#03a9f4;}
.num-btn:nth-child(7) {background:#00bcd4;}
.num-btn:nth-child(8) {background:#009688;}
.num-btn:nth-child(9) {background:#4caf50;}
.num-btn:nth-child(10) {background:#8bc34a;}
.del-btn {background:#ff5722 !important;}
.score-box {font-size:20px;color:#e91e63;margin:15px 0;font-weight:bold;}
.result {font-size:22px;margin:12px 0;font-weight:bold;padding:10px;border-radius:10px;}
.success {color:#4caf50;background:#e8f5e9;border:2px solid #c8e6c9;}
.error {color:#f44336;background:#ffebee;border:2px solid #ffcdd2;}
</style>
</head>
<body>
<div class="game-container">
<h1 class="title">æ•°å­¦ç‹å›½å¤§é—¯å…³</h1>
<div class="level-info" id="levelText">å½“å‰å…³å¡ï¼š1 åŸå ¡å¤§é—¨</div>
<div class="score-box">ç´¯è®¡æ˜Ÿæ˜Ÿï¼š<span id="score">0</span>é¢—</div>
<div class="question-box">
<span id="questionPart">?</span>
<span class="answer-display" id="answerDisplay"></span>
</div>
<div class="num-keyboard">
<button class="num-btn">1</button><button class="num-btn">2</button><button class="num-btn">3</button>
<button class="num-btn">4</button><button class="num-btn">5</button><button class="num-btn">6</button>
<button class="num-btn">7</button><button class="num-btn">8</button><button class="num-btn">9</button>
<button class="num-btn">0</button><button class="num-btn del-btn" id="delBtn">åˆ é™¤</button>
</div>
<div class="result" id="result"></div>
</div>

<script>
// é—®é¢˜åº“
const questionBank = [
["3Ã—5+6=",21],["23+18=",41],["80-56=",24],["7Ã—4=",28],["45-19+27=",53],["9Ã—2=",18],["6+8Ã—3=",30],["72-45=",27],
["5Ã—7-10=",25],["36+24=",60],["91-28=",63],["8Ã—6+5=",53],["63-17=",46],["22+7Ã—3=",43],["4Ã—9=",36],["54-29+16=",41]
];

// å…³å¡åç§°
const levelNames = ["åŸå ¡å¤§é—¨","èŠ±å›­å°å¾„","æ£®æ—è¿·å®«","æ¹–æ³ŠçŸ³æ¡¥","å®è—å±‹"];

// é‡ç‚¹ï¼šè¡¨æ‰¬è¯æœ¯å’Œå¤±è´¥æç¤º
const successMessages = [
    "ç­”å¯¹äº†ï¼ä½ çœŸæ£’ğŸ‘",
    "ä½ åˆç­”å¯¹äº†ï¼å¤ªå‰å®³äº†ğŸ‘",
    "åšå¾—å¥½ï¼ç»§ç»­åŠ æ²¹ğŸ’ª",
    "æ­£ç¡®ï¼ä½ çœŸèªæ˜ğŸ¤©",
    "å¤ªæ£’äº†ï¼å®Œç¾è§£ç­”ğŸ‰",
    "ç­”å¯¹å•¦ï¼æ•°å­¦å°å¤©æ‰å°±æ˜¯ä½ ğŸ’¯"
];

const errorMessages = [
    "âš ï¸ å†è¯•ä¸€æ¬¡å§ï¼ŒåŠ æ²¹å“¦ï¼",
    "âš ï¸ å·®ä¸€ç‚¹å°±å¯¹äº†ï¼Œç»§ç»­åŠªåŠ›ï¼",
    "âš ï¸ æ²¡å…³ç³»ï¼Œå¤šç»ƒä¹ å°±ä¼šäº†ï¼",
    "âš ï¸ åˆ«ç°å¿ƒï¼Œä¸‹æ¬¡ä¸€å®šèƒ½ç­”å¯¹ï¼",
    "âš ï¸ å†æƒ³æƒ³çœ‹ï¼Œä½ å¯ä»¥çš„ï¼",
    "âš ï¸ åŠ æ²¹ï¼Œç›¸ä¿¡ä½ èƒ½åšå¯¹çš„ï¼"
];

// æ¸¸æˆçŠ¶æ€
let currentLevel = 0;
let currentQuestion = 0;
let score = 0;
let userAnswer = "";
let isChecking = false;

// é…ç½®
const questionsPerLevel = 8;
const answerDelay = 1200;

// DOMå…ƒç´ 
const levelText = document.getElementById('levelText');
const questionPart = document.getElementById('questionPart');
const answerDisplay = document.getElementById('answerDisplay');
const result = document.getElementById('result');
const scoreSpan = document.getElementById('score');
const delBtn = document.getElementById('delBtn');
const numBtns = document.querySelectorAll('.num-btn:not(#delBtn)');

// åˆå§‹åŒ–æ¸¸æˆ
function initGame() {
    const qIndex = currentLevel * questionsPerLevel + currentQuestion;
    if (qIndex >= questionBank.length) return;
    
    questionPart.textContent = questionBank[qIndex][0];
    result.textContent = "";
    userAnswer = "";
    answerDisplay.textContent = "";
    isChecking = false;
}

// æ’­æ”¾å£°éŸ³
function playSound(frequency = 440, duration = 0.1) {
    try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = frequency;
        oscillator.type = 'sine';
        
        gainNode.gain.value = 0.1;
        
        oscillator.start();
        oscillator.stop(audioContext.currentTime + duration);
    } catch (e) {
        // éŸ³é¢‘ä¸æ”¯æŒæ—¶é™é»˜å¤±è´¥
    }
}

// æ•°å­—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
numBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        if (isChecking) return;
        
        const num = btn.textContent;
        
        // é¿å…å‰å¯¼é›¶
        if (userAnswer === "" && num === "0") return;
        
        // æœ€å¤šè¾“å…¥2ä½æ•°å­—
        if (userAnswer.length >= 2) return;
        
        // æ’­æ”¾æŒ‰é”®å£°éŸ³
        playSound(440 + Math.random() * 200);
        
        userAnswer += num;
        answerDisplay.textContent = userAnswer;
        
        checkAnswer();
    });
});

// åˆ é™¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶
delBtn.addEventListener('click', () => {
    if (isChecking) return;
    
    userAnswer = userAnswer.slice(0, -1);
    answerDisplay.textContent = userAnswer;
});

// æ£€æŸ¥ç­”æ¡ˆ
function checkAnswer() {
    const qIndex = currentLevel * questionsPerLevel + currentQuestion;
    const correctAnswer = questionBank[qIndex][1];
    
    // å½“è¾“å…¥é•¿åº¦ç­‰äºæ­£ç¡®ç­”æ¡ˆé•¿åº¦æˆ–è¾¾åˆ°2ä½æ—¶è‡ªåŠ¨æäº¤
    if (userAnswer.length === String(correctAnswer).length || userAnswer.length === 2) {
        submitAnswer();
    }
}

// æäº¤ç­”æ¡ˆ
function submitAnswer() {
    isChecking = true;
    
    const qIndex = currentLevel * questionsPerLevel + currentQuestion;
    const correctAnswer = questionBank[qIndex][1];
    const inputNum = Number(userAnswer);
    
    if (inputNum === correctAnswer) {
        // ç­”å¯¹äº†
        const message = successMessages[Math.floor(Math.random() * successMessages.length)];
        result.textContent = message;
        result.className = 'result success';
        score++;
        playSound(523, 0.2); // é«˜éŸ³è¡¨ç¤ºæ­£ç¡®
    } else {
        // ç­”é”™äº†
        const message = errorMessages[Math.floor(Math.random() * errorMessages.length)];
        result.textContent = `${message} æ­£ç¡®ç­”æ¡ˆæ˜¯ ${correctAnswer}`;
        result.className = 'result error';
        score = Math.max(0, score - 1);
        playSound(220, 0.2); // ä½éŸ³è¡¨ç¤ºé”™è¯¯
    }
    
    scoreSpan.textContent = score;
    
    // å‡†å¤‡ä¸‹ä¸€é¢˜
    setTimeout(() => {
        if (currentQuestion < questionsPerLevel - 1) {
            currentQuestion++;
        } else if (currentLevel < levelNames.length - 1) {
            currentLevel++;
            currentQuestion = 0;
            levelText.textContent = `å½“å‰å…³å¡ï¼š${currentLevel + 1} ${levelNames[currentLevel]}`;
        } else {
            // æ¸¸æˆç»“æŸ
            result.textContent = `ğŸ‰ æ­å–œé€šå…³ï¼ä½ æ€»å…±è·å¾—äº† ${score} é¢—æ˜Ÿæ˜Ÿï¼`;
            result.className = 'result success';
            return;
        }
        
        initGame();
    }, answerDelay);
}

// åˆå§‹åŒ–æ¸¸æˆ
initGame();
</script>
</body>
</html>
